category: data_exfiltration
description: "Data exfiltration detection rules"

rules:
  critical:
    - id: DE001
      pattern: "curl.*-X\\s*POST|wget.*--post|fetch\\(.*method.*POST"
      description: "HTTP POST data exfiltration"
      description_zh: "HTTP POST 数据外传"

    - id: DE002
      pattern: "curl.*\\$\\(|curl.*`|curl.*\\$\\{|curl.*\\$HOME|curl.*\\$ENV"
      description: "curl sending env vars / dynamic content"
      description_zh: "curl 发送环境变量/动态内容"

    - id: DE003
      pattern: "curl.*-X\\s*(GET|POST|PUT).*http(s)?://.*\\.com|curl.*exfil|curl.*leak|curl.*steal"
      description: "curl data exfiltration to external domain"
      description_zh: "curl 向外部域名发送数据"

    - id: DE004
      pattern: "wget.*--post-file|wget.*\\$\\(|wget.*--save-cookies|wget.*--load-cookies"
      description: "wget data exfiltration"
      description_zh: "wget 数据外传"

    - id: DE005
      pattern: "tee\\s+/dev/tcp|nc\\s+.*\\$|socat.*TCP|python.*socket.*connect"
      description: "Network socket data transfer"
      description_zh: "网络套接字数据传输"

  high:
    - id: DE003
      pattern: "\\.env|auth-profiles\\.json|credentials|api[_-]?key|secret[_-]?key|private[_-]?key"
      description: "Access sensitive credential files"
      description_zh: "访问敏感凭据文件"

    - id: DE004
      pattern: "ssh[_-]?(key|rsa|ed25519)|id_rsa|id_ed25519|known_hosts"
      description: "SSH key access"
      description_zh: "SSH 密钥访问"

    - id: DE005
      pattern: "keychain|login\\.keychain|security find"
      description: "macOS Keychain access"
      description_zh: "macOS 钥匙串访问"
